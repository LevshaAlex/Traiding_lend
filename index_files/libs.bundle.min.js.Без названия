var enableInlineVideo=function(){"use strict";function d(i,n,r){function e(e){r&&!r(i,n)||e.stopImmediatePropagation()}return i.addEventListener(n,e),e}function a(e,i,n,r){function t(e){n[i]=e}r&&t(e[i]),Object.defineProperty(e,i,{get:function(){return n[i]},set:t})}function o(e,i,n){n.addEventListener(i,function(){return e.dispatchEvent(new Event(i))})}function u(e,i){Promise.resolve().then(function(){e.dispatchEvent(new Event(i))})}function s(e,i,n){(r||0)+200<Date.now()&&(e[g]=!0,r=Date.now()),n||(e.currentTime=i),E[++t%3]=100*i|0}function c(e){return e.driver.currentTime>=e.video.duration}function v(){var e=this,i=e[m];e.webkitDisplayingFullscreen?e[b]():("data:"!==i.driver.src&&i.driver.src!==e.src&&(s(e,0,!0),i.driver.src=e.src),e.paused&&(i.paused=!1,0===e.buffered.length&&e.load(),i.driver.play(),i.updater.start(),i.hasAudio||(u(e,"play"),i.video.readyState>=i.video.HAVE_ENOUGH_DATA&&u(e,"playing"))))}function p(e){var i=this,n=i[m];n.driver.pause(),n.updater.stop(),i.webkitDisplayingFullscreen&&i[h](),n.paused&&!e||(n.paused=!0,n.hasAudio||u(i,"pause"),i.ended&&!i.webkitDisplayingFullscreen&&(i[g]=!0,u(i,"ended")))}function l(i,n){var e,r,t={};(i[m]=t).paused=!0,t.hasAudio=n,t.video=i,t.updater=function(i,n,e,r){function t(e){d=n(t,r),i(e-(a||e)),a=e}var d,a;return{start:function(){d||t(0)},stop:function(){e(d),d=null,a=0}}}(function(e){var i=this;i.video.readyState>=i.video.HAVE_FUTURE_DATA?(i.hasAudio||(i.driver.currentTime=i.video.currentTime+e*i.video.playbackRate/1e3,i.video.loop&&c(i)&&(i.driver.currentTime=0)),s(i.video,i.driver.currentTime)):i.video.networkState===i.video.NETWORK_IDLE&&0===i.video.buffered.length&&i.video.load(),i.video.ended&&(delete i.video[g],i.video.pause(!0))}.bind(t),requestAnimationFrame,cancelAnimationFrame),n?t.driver=(e=i,r=new Audio,o(e,"play",r),o(e,"playing",r),o(e,"pause",r),r.crossOrigin=e.crossOrigin,r.src=e.src||e.currentSrc||"data:",r):(i.addEventListener("canplay",function(){i.paused||u(i,"playing")}),t.driver={src:i.src||i.currentSrc||"data:",muted:!0,paused:!0,pause:function(){t.driver.paused=!0},play:function(){t.driver.paused=!1,c(t)&&s(i,0)},get ended(){return c(t)}}),i.addEventListener("emptied",function(){var e=!t.driver.src||"data:"===t.driver.src;t.driver.src&&t.driver.src!==i.src&&(s(i,0,!0),t.driver.src=i.src,e||!n&&i.autoplay?t.driver.play():t.updater.stop())},!1),i.addEventListener("webkitbeginfullscreen",function(){i.paused?n&&0===t.driver.buffered.length&&t.driver.load():(i.pause(),i[b]())}),n&&(i.addEventListener("webkitendfullscreen",function(){t.driver.currentTime=i.currentTime}),i.addEventListener("seeking",function(){E.indexOf(100*i.currentTime|0)<0&&(t.driver.currentTime=i.currentTime)}))}function f(e){var i=e[g];return delete e[g],!e.webkitDisplayingFullscreen&&!i}var r,y="object"==typeof document&&"object-fit"in document.head.style&&!matchMedia("(-webkit-video-playable-inline)").matches,m="bfred-it:iphone-inline-video",g="bfred-it:iphone-inline-video:event",b="bfred-it:iphone-inline-video:nativeplay",h="bfred-it:iphone-inline-video:nativepause",E=[],t=0;return function(i,e){if(void 0===e&&(e={}),!i[m]){if(!e.everywhere){if(!y)return;if(!(e.iPad||e.ipad?/iPhone|iPod|iPad/:/iPhone|iPod/).test(navigator.userAgent))return}i.pause();var n=i.autoplay;i.autoplay=!1,l(i,!i.muted),t=(r=i)[m],r[b]=r.play,r[h]=r.pause,r.play=v,r.pause=p,a(r,"paused",t.driver),a(r,"muted",t.driver,!0),a(r,"playbackRate",t.driver,!0),a(r,"ended",t.driver),a(r,"loop",t.driver,!0),d(r,"seeking",function(e){return!e.webkitDisplayingFullscreen}),d(r,"seeked",function(e){return!e.webkitDisplayingFullscreen}),d(r,"timeupdate",f),d(r,"ended",f),i.classList.add("IIV"),i.muted&&n&&(i.play(),i.addEventListener("playing",function e(){i.autoplay=!0,i.removeEventListener("playing",e)})),/iPhone|iPod|iPad/.test(navigator.platform)||console.warn("iphone-inline-video is not guaranteed to work in emulated environments")}var r,t}}();